<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Data wrangling | Fundamental plots for electrophysiological data</title>
  <meta name="description" content="<p>A walkthrough on how to produce fundamental plots from electrophysiological
data. Developed by the Alshuler Lab at the University of British Columbia.</p>" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Data wrangling | Fundamental plots for electrophysiological data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>A walkthrough on how to produce fundamental plots from electrophysiological
data. Developed by the Alshuler Lab at the University of British Columbia.</p>" />
  <meta name="github-repo" content="flightlab/ephys_fundamental_plots" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Data wrangling | Fundamental plots for electrophysiological data" />
  
  <meta name="twitter:description" content="<p>A walkthrough on how to produce fundamental plots from electrophysiological
data. Developed by the Alshuler Lab at the University of British Columbia.</p>" />
  

<meta name="author" content="Vikram B. Baliga" />


<meta name="date" content="2023-02-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="raw-data-and-spike-sorted-traces.html"/>
<link rel="next" href="raster-and-mean-spike-rate-plots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamental plots for electrophysiological data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>2</b> Preface</a>
<ul>
<li class="chapter" data-level="2.1" data-path="preface.html"><a href="preface.html#r-packages-versioning"><i class="fa fa-check"></i><b>2.1</b> R packages &amp; versioning</a></li>
<li class="chapter" data-level="2.2" data-path="preface.html"><a href="preface.html#not_in"><i class="fa fa-check"></i><b>2.2</b> <code>%not_in%</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spike-sorting.html"><a href="spike-sorting.html"><i class="fa fa-check"></i><b>3</b> Spike sorting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spike-sorting.html"><a href="spike-sorting.html#spike2"><i class="fa fa-check"></i><b>3.1</b> Spike2</a></li>
<li class="chapter" data-level="3.2" data-path="spike-sorting.html"><a href="spike-sorting.html#neuralynx"><i class="fa fa-check"></i><b>3.2</b> Neuralynx</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raw-data-and-spike-sorted-traces.html"><a href="raw-data-and-spike-sorted-traces.html"><i class="fa fa-check"></i><b>4</b> Raw data and spike sorted traces</a>
<ul>
<li class="chapter" data-level="4.1" data-path="raw-data-and-spike-sorted-traces.html"><a href="raw-data-and-spike-sorted-traces.html#including-plots"><i class="fa fa-check"></i><b>4.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#import-example-file-and-metadata"><i class="fa fa-check"></i><b>5.1</b> Import example file and metadata</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#identify-files-to-import"><i class="fa fa-check"></i><b>5.1.1</b> Identify files to import</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-import-and-preliminary-labeling"><i class="fa fa-check"></i><b>5.1.2</b> Data import and preliminary labeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html"><i class="fa fa-check"></i><b>6</b> Raster and mean spike rate plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html#including-plots-1"><i class="fa fa-check"></i><b>6.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatiotemporal-tuning.html"><a href="spatiotemporal-tuning.html"><i class="fa fa-check"></i><b>7</b> Spatiotemporal tuning</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatiotemporal-tuning.html"><a href="spatiotemporal-tuning.html#including-plots-2"><i class="fa fa-check"></i><b>7.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="histological-verification.html"><a href="histological-verification.html"><i class="fa fa-check"></i><b>8</b> Histological verification</a>
<ul>
<li class="chapter" data-level="8.1" data-path="histological-verification.html"><a href="histological-verification.html#including-plots-3"><i class="fa fa-check"></i><b>8.1</b> Including Plots</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamental plots for electrophysiological data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Data wrangling<a href="data-wrangling.html#data-wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Once data have been spike sorted, we are ready to begin working in <code>R</code>. To get
to a point where meaningful preliminary plots can be produced, a few things need
to be addressed:</p>
<ol style="list-style-type: decimal">
<li><p>Labeling the time series of spike &amp; photodiode data based on the stimulus
that appears on screen (i.e., matching the log file to the data file). This
includes labeling phases (like “blank”, “stationary”, and “moving”) along
with experimental metadata such as SF, TF, and stimulus orientation
(direction).</p></li>
<li><p>Re-organizing the spike &amp; photodiode so that separate replicates of a
stimulus run are uniquely labelled and then arranged together.</p></li>
<li><p>Binning the data into 10- and 100-ms data sets, and then exporting CSVs of
the unbinned, 10-ms-binned, and 100-ms-binned data. This will be highly
useful for situations where you are handling multiple data files (e.g., from
different recording days), in which case it is likely that your machine will
not be able to store all objects in RAM.</p></li>
</ol>
<blockquote>
<p>Before proceeding any further, please ensure you have installed and loaded all
the necessary <code>R</code> packages as detailed in the Preface section of this guide.</p>
</blockquote>
<div id="import-example-file-and-metadata" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Import example file and metadata<a href="data-wrangling.html#import-example-file-and-metadata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will use a recently-collected data file and its corresponding metadata file
to showcase the fundamentals of wrangling ephys data into a more easily
plot-able format.</p>
<div id="identify-files-to-import" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Identify files to import<a href="data-wrangling.html#identify-files-to-import" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following code is based on the assumptions that: 1) Your files are stored in
a directory entitled <code>/data</code> 2) The basename of each file (i.e., the name of the
file, excluding the file extension) is identical for each set of spike sorted
data and corresponding metadata log file (e.g., <code>04132022_009m.mat</code> and
<code>04132022_009m</code> have the same basename, which is <code>04132022_009m</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-wrangling.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## List all files of each file type</span></span>
<span id="cb6-2"><a href="data-wrangling.html#cb6-2" aria-hidden="true" tabindex="-1"></a>csv_files <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="data-wrangling.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">&quot;./data&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;.csv&quot;</span>,</span>
<span id="cb6-4"><a href="data-wrangling.html#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-5"><a href="data-wrangling.html#cb6-5" aria-hidden="true" tabindex="-1"></a>mat_files <span class="ot">&lt;-</span></span>
<span id="cb6-6"><a href="data-wrangling.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">&quot;./data&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;.mat&quot;</span>,</span>
<span id="cb6-7"><a href="data-wrangling.html#cb6-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-8"><a href="data-wrangling.html#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="data-wrangling.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate metadata tibbles for each file type</span></span>
<span id="cb6-10"><a href="data-wrangling.html#cb6-10" aria-hidden="true" tabindex="-1"></a>csv_file_info <span class="ot">&lt;-</span></span>
<span id="cb6-11"><a href="data-wrangling.html#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb6-12"><a href="data-wrangling.html#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">csv_files =</span> csv_files,</span>
<span id="cb6-13"><a href="data-wrangling.html#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Extract the basename by removing the file extension</span></span>
<span id="cb6-14"><a href="data-wrangling.html#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">basename =</span>  <span class="fu">basename</span>(csv_files) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">&quot;.csv&quot;</span>),</span>
<span id="cb6-15"><a href="data-wrangling.html#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">## </span><span class="al">NOTE</span><span class="do">: PLEASE ADJUST THE FOLLOWING LINE TO BE ABLE TO EXCTRACT OUT THE</span></span>
<span id="cb6-16"><a href="data-wrangling.html#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">## DATE BASED ON YOUR NAMING CONVENTION</span></span>
<span id="cb6-17"><a href="data-wrangling.html#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">basedate =</span>  <span class="fu">basename</span>(csv_files) <span class="sc">%&gt;%</span> <span class="fu">str_sub</span>(<span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">12</span>)</span>
<span id="cb6-18"><a href="data-wrangling.html#cb6-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-19"><a href="data-wrangling.html#cb6-19" aria-hidden="true" tabindex="-1"></a>mat_file_info <span class="ot">&lt;-</span></span>
<span id="cb6-20"><a href="data-wrangling.html#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb6-21"><a href="data-wrangling.html#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">mat_files =</span> mat_files,</span>
<span id="cb6-22"><a href="data-wrangling.html#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Extract the basename by removing the file extension</span></span>
<span id="cb6-23"><a href="data-wrangling.html#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">basename =</span>  <span class="fu">basename</span>(mat_files) <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">&quot;.mat&quot;</span>),</span>
<span id="cb6-24"><a href="data-wrangling.html#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="do">## </span><span class="al">NOTE</span><span class="do">: AGAIN, PLEASE ADJUST THE FOLLOWING LINE TO BE ABLE TO EXCTRACT OUT</span></span>
<span id="cb6-25"><a href="data-wrangling.html#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="do">## THE DATE BASED ON YOUR NAMING CONVENTION</span></span>
<span id="cb6-26"><a href="data-wrangling.html#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">basedate =</span>  <span class="fu">basename</span>(mat_files) <span class="sc">%&gt;%</span> <span class="fu">str_sub</span>(<span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">12</span>)</span>
<span id="cb6-27"><a href="data-wrangling.html#cb6-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-28"><a href="data-wrangling.html#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="data-wrangling.html#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Matchmake between .MAT data and .CSV log files</span></span>
<span id="cb6-30"><a href="data-wrangling.html#cb6-30" aria-hidden="true" tabindex="-1"></a>csv_mat_filejoin <span class="ot">&lt;-</span></span>
<span id="cb6-31"><a href="data-wrangling.html#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(csv_file_info, mat_file_info, <span class="at">by =</span> <span class="st">&quot;basename&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="data-wrangling.html#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="do">## OPTIONAL STEP: remove any rows where either the .MAT or .CSV is missing</span></span>
<span id="cb6-33"><a href="data-wrangling.html#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb6-34"><a href="data-wrangling.html#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="data-wrangling.html#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Store a vector of basenames in the environment. This will become useful later</span></span>
<span id="cb6-36"><a href="data-wrangling.html#cb6-36" aria-hidden="true" tabindex="-1"></a>base_names <span class="ot">&lt;-</span> csv_mat_filejoin<span class="sc">$</span>basename</span>
<span id="cb6-37"><a href="data-wrangling.html#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="data-wrangling.html#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Your end products from this code block should look something like:</span></span>
<span id="cb6-39"><a href="data-wrangling.html#cb6-39" aria-hidden="true" tabindex="-1"></a>csv_mat_filejoin</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   csv_files                basename      basedate.x   mat_files       basedate.y
##   &lt;chr&gt;                    &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;           &lt;chr&gt;     
## 1 ./data/04132022_009m.csv 04132022_009m 04132022_009 ./data/0413202… 04132022_…</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-wrangling.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## and:</span></span>
<span id="cb8-2"><a href="data-wrangling.html#cb8-2" aria-hidden="true" tabindex="-1"></a>base_names</span></code></pre></div>
<pre><code>## [1] &quot;04132022_009m&quot;</code></pre>
</div>
<div id="data-import-and-preliminary-labeling" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Data import and preliminary labeling<a href="data-wrangling.html#data-import-and-preliminary-labeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will now use the <code>R.matlab</code> package to import the <code>.mat</code> file into R and then
label the spike and photodiode time series based on the information in the
<code>.csv</code> log file</p>
<p>Because <code>.mat</code> files can be large, data import can take several minutes.</p>
<p>Please see in-line comments for further guidance</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-wrangling.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tidy up how R has been using RAM by running garbage collection</span></span>
<span id="cb10-2"><a href="data-wrangling.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2527151 135.0    3985512 212.9  3985512 212.9
## Vcells 4334001  33.1   10146329  77.5  7077614  54.0</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-wrangling.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set up empty vectors that will collect sets of replicates that we will be</span></span>
<span id="cb12-2"><a href="data-wrangling.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## splitting up</span></span>
<span id="cb12-3"><a href="data-wrangling.html#cb12-3" aria-hidden="true" tabindex="-1"></a>metadata_sets <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-4"><a href="data-wrangling.html#cb12-4" aria-hidden="true" tabindex="-1"></a>meta_splits <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-5"><a href="data-wrangling.html#cb12-5" aria-hidden="true" tabindex="-1"></a>data_splits <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-6"><a href="data-wrangling.html#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="data-wrangling.html#cb12-7" aria-hidden="true" tabindex="-1"></a>starttime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() <span class="do">## optional, this will help you assess total import time</span></span>
<span id="cb12-8"><a href="data-wrangling.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(csv_mat_filejoin)) {</span>
<span id="cb12-9"><a href="data-wrangling.html#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="data-wrangling.html#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Which file # are we working on?</span></span>
<span id="cb12-11"><a href="data-wrangling.html#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb12-12"><a href="data-wrangling.html#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="data-wrangling.html#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Set up temporary objects in which to eventually write data</span></span>
<span id="cb12-14"><a href="data-wrangling.html#cb12-14" aria-hidden="true" tabindex="-1"></a>  csv_data_sets <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-15"><a href="data-wrangling.html#cb12-15" aria-hidden="true" tabindex="-1"></a>  mat_data_sets <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-16"><a href="data-wrangling.html#cb12-16" aria-hidden="true" tabindex="-1"></a>  joined_data_sets <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-17"><a href="data-wrangling.html#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="data-wrangling.html#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Import the matlab file. This may take some time</span></span>
<span id="cb12-19"><a href="data-wrangling.html#cb12-19" aria-hidden="true" tabindex="-1"></a>  mat_import <span class="ot">&lt;-</span></span>
<span id="cb12-20"><a href="data-wrangling.html#cb12-20" aria-hidden="true" tabindex="-1"></a>    R.matlab<span class="sc">::</span><span class="fu">readMat</span>(csv_mat_filejoin[i,<span class="st">&quot;mat_files&quot;</span>])</span>
<span id="cb12-21"><a href="data-wrangling.html#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="data-wrangling.html#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Read in the corresponding csv log file</span></span>
<span id="cb12-23"><a href="data-wrangling.html#cb12-23" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-24"><a href="data-wrangling.html#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(csv_mat_filejoin[i,<span class="st">&quot;csv_files&quot;</span>],</span>
<span id="cb12-25"><a href="data-wrangling.html#cb12-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="data-wrangling.html#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Rename columns for convenience</span></span>
<span id="cb12-27"><a href="data-wrangling.html#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb12-28"><a href="data-wrangling.html#cb12-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Spatial_Frequency =</span> <span class="st">`</span><span class="at">Spatial Frequency</span><span class="st">`</span>,</span>
<span id="cb12-29"><a href="data-wrangling.html#cb12-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">Temporal_Frequency =</span> <span class="st">`</span><span class="at">Temporal Frequency</span><span class="st">`</span></span>
<span id="cb12-30"><a href="data-wrangling.html#cb12-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-31"><a href="data-wrangling.html#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Set up a `SF_cpd` column that tranlates SFs to cycles per degree</span></span>
<span id="cb12-32"><a href="data-wrangling.html#cb12-32" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency <span class="sc">==</span> <span class="fl">0.000668</span>] <span class="ot">&lt;-</span></span>
<span id="cb12-33"><a href="data-wrangling.html#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">^-</span><span class="dv">6</span></span>
<span id="cb12-34"><a href="data-wrangling.html#cb12-34" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency <span class="sc">==</span> <span class="fl">0.001336</span>] <span class="ot">&lt;-</span></span>
<span id="cb12-35"><a href="data-wrangling.html#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">^-</span><span class="dv">5</span></span>
<span id="cb12-36"><a href="data-wrangling.html#cb12-36" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency <span class="sc">==</span> <span class="fl">0.00267</span>]  <span class="ot">&lt;-</span></span>
<span id="cb12-37"><a href="data-wrangling.html#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">^-</span><span class="dv">4</span></span>
<span id="cb12-38"><a href="data-wrangling.html#cb12-38" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency <span class="sc">==</span> <span class="fl">0.0053</span>]   <span class="ot">&lt;-</span></span>
<span id="cb12-39"><a href="data-wrangling.html#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">^-</span><span class="dv">3</span></span>
<span id="cb12-40"><a href="data-wrangling.html#cb12-40" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency <span class="sc">==</span> <span class="fl">0.0106</span>]   <span class="ot">&lt;-</span></span>
<span id="cb12-41"><a href="data-wrangling.html#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">^-</span><span class="dv">2</span></span>
<span id="cb12-42"><a href="data-wrangling.html#cb12-42" aria-hidden="true" tabindex="-1"></a>  csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency <span class="sc">==</span> <span class="fl">0.0212</span>]   <span class="ot">&lt;-</span></span>
<span id="cb12-43"><a href="data-wrangling.html#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">^-</span><span class="dv">1</span></span>
<span id="cb12-44"><a href="data-wrangling.html#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="data-wrangling.html#cb12-45" aria-hidden="true" tabindex="-1"></a>  <span class="do">## The log file does not have time = 0, so set up a separate tibble to </span></span>
<span id="cb12-46"><a href="data-wrangling.html#cb12-46" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add this info in later. Some of the metadata will just be filler for now.</span></span>
<span id="cb12-47"><a href="data-wrangling.html#cb12-47" aria-hidden="true" tabindex="-1"></a>  initial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-48"><a href="data-wrangling.html#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Trial =</span> <span class="st">&quot;initialization&quot;</span>,</span>
<span id="cb12-49"><a href="data-wrangling.html#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Spatial_Frequency =</span> csv_data_sets[[i]]<span class="sc">$</span>Spatial_Frequency[<span class="dv">1</span>],</span>
<span id="cb12-50"><a href="data-wrangling.html#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">SF_cpd =</span> csv_data_sets[[i]]<span class="sc">$</span>SF_cpd[<span class="dv">1</span>],</span>
<span id="cb12-51"><a href="data-wrangling.html#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Temporal_Frequency =</span> csv_data_sets[[i]]<span class="sc">$</span>Temporal_Frequency[<span class="dv">1</span>],</span>
<span id="cb12-52"><a href="data-wrangling.html#cb12-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Direction  =</span> csv_data_sets[[i]]<span class="sc">$</span>Direction[<span class="dv">1</span>],</span>
<span id="cb12-53"><a href="data-wrangling.html#cb12-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Time =</span> <span class="fl">0.000</span></span>
<span id="cb12-54"><a href="data-wrangling.html#cb12-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-55"><a href="data-wrangling.html#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="data-wrangling.html#cb12-56" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Determine when the onset of motion occurred according to matlab</span></span>
<span id="cb12-57"><a href="data-wrangling.html#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="do">## </span><span class="al">NOTE</span><span class="do">: IF THIS INFO IS NOT IN CHANNEL 3, PLEASE CHANGE ACCCORDINGLY</span></span>
<span id="cb12-58"><a href="data-wrangling.html#cb12-58" aria-hidden="true" tabindex="-1"></a>  first_moving_mat <span class="ot">&lt;-</span></span>
<span id="cb12-59"><a href="data-wrangling.html#cb12-59" aria-hidden="true" tabindex="-1"></a>    mat_import[[stringr<span class="sc">::</span><span class="fu">str_which</span>(<span class="fu">names</span>(mat_import), <span class="st">&quot;Ch3&quot;</span>)[<span class="dv">1</span>]]][[<span class="dv">5</span>]][,<span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb12-60"><a href="data-wrangling.html#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find the first &quot;moving&quot; phase in the log file</span></span>
<span id="cb12-61"><a href="data-wrangling.html#cb12-61" aria-hidden="true" tabindex="-1"></a>  first_moving_csv <span class="ot">&lt;-</span></span>
<span id="cb12-62"><a href="data-wrangling.html#cb12-62" aria-hidden="true" tabindex="-1"></a>    csv_data_sets[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb12-63"><a href="data-wrangling.html#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Trial <span class="sc">==</span> <span class="st">&quot;moving&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-64"><a href="data-wrangling.html#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb12-65"><a href="data-wrangling.html#cb12-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-66"><a href="data-wrangling.html#cb12-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb12-67"><a href="data-wrangling.html#cb12-67" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Find the first &quot;blank&quot; phase in the log file</span></span>
<span id="cb12-68"><a href="data-wrangling.html#cb12-68" aria-hidden="true" tabindex="-1"></a>  first_blank <span class="ot">&lt;-</span></span>
<span id="cb12-69"><a href="data-wrangling.html#cb12-69" aria-hidden="true" tabindex="-1"></a>    csv_data_sets[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb12-70"><a href="data-wrangling.html#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Trial <span class="sc">==</span> <span class="st">&quot;blank&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-71"><a href="data-wrangling.html#cb12-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb12-72"><a href="data-wrangling.html#cb12-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-73"><a href="data-wrangling.html#cb12-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb12-74"><a href="data-wrangling.html#cb12-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Compute the difference between these two</span></span>
<span id="cb12-75"><a href="data-wrangling.html#cb12-75" aria-hidden="true" tabindex="-1"></a>  first_mvbl_diff <span class="ot">&lt;-</span> first_moving_csv <span class="sc">-</span> first_blank</span>
<span id="cb12-76"><a href="data-wrangling.html#cb12-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-77"><a href="data-wrangling.html#cb12-77" aria-hidden="true" tabindex="-1"></a>  first_csv_tmp <span class="ot">&lt;-</span></span>
<span id="cb12-78"><a href="data-wrangling.html#cb12-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(initial, csv_data_sets[[i]]) <span class="sc">%&gt;%</span></span>
<span id="cb12-79"><a href="data-wrangling.html#cb12-79" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Add the first event time to &quot;Time&quot; and subtract first_mvbl_diff (~2 secs)</span></span>
<span id="cb12-80"><a href="data-wrangling.html#cb12-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time =</span> Time <span class="sc">+</span> first_moving_mat <span class="sc">-</span> first_mvbl_diff <span class="sc">-</span> first_blank) <span class="sc">%&gt;%</span></span>
<span id="cb12-81"><a href="data-wrangling.html#cb12-81" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Make character version of Time for joining later</span></span>
<span id="cb12-82"><a href="data-wrangling.html#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="do">## This will be crucial for _join functions</span></span>
<span id="cb12-83"><a href="data-wrangling.html#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time_char =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(Time,<span class="dv">3</span>)))</span>
<span id="cb12-84"><a href="data-wrangling.html#cb12-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-85"><a href="data-wrangling.html#cb12-85" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Duplicate the initialization for ease of setting T0</span></span>
<span id="cb12-86"><a href="data-wrangling.html#cb12-86" aria-hidden="true" tabindex="-1"></a>  inception <span class="ot">&lt;-</span></span>
<span id="cb12-87"><a href="data-wrangling.html#cb12-87" aria-hidden="true" tabindex="-1"></a>    initial <span class="sc">%&gt;%</span></span>
<span id="cb12-88"><a href="data-wrangling.html#cb12-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time_char =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(Time,<span class="dv">3</span>)))</span>
<span id="cb12-89"><a href="data-wrangling.html#cb12-89" aria-hidden="true" tabindex="-1"></a>  inception<span class="sc">$</span>Trial[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;inception&quot;</span></span>
<span id="cb12-90"><a href="data-wrangling.html#cb12-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-91"><a href="data-wrangling.html#cb12-91" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Bind the initialization rows</span></span>
<span id="cb12-92"><a href="data-wrangling.html#cb12-92" aria-hidden="true" tabindex="-1"></a>  first_csv <span class="ot">&lt;-</span></span>
<span id="cb12-93"><a href="data-wrangling.html#cb12-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(inception, first_csv_tmp)</span>
<span id="cb12-94"><a href="data-wrangling.html#cb12-94" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Compute stimulus end times</span></span>
<span id="cb12-95"><a href="data-wrangling.html#cb12-95" aria-hidden="true" tabindex="-1"></a>  first_csv<span class="sc">$</span>Stim_end <span class="ot">&lt;-</span> <span class="fu">c</span>(first_csv<span class="sc">$</span>Time[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">max</span>(first_csv<span class="sc">$</span>Time) <span class="sc">+</span> <span class="dv">3</span>)</span>
<span id="cb12-96"><a href="data-wrangling.html#cb12-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-97"><a href="data-wrangling.html#cb12-97" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Get final time</span></span>
<span id="cb12-98"><a href="data-wrangling.html#cb12-98" aria-hidden="true" tabindex="-1"></a>  final_time <span class="ot">&lt;-</span> first_csv<span class="sc">$</span>Stim_end[<span class="fu">nrow</span>(first_csv)]</span>
<span id="cb12-99"><a href="data-wrangling.html#cb12-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-100"><a href="data-wrangling.html#cb12-100" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Extract matlab spike and photodiode data</span></span>
<span id="cb12-101"><a href="data-wrangling.html#cb12-101" aria-hidden="true" tabindex="-1"></a>  mat_data_sets[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-102"><a href="data-wrangling.html#cb12-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb12-103"><a href="data-wrangling.html#cb12-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time =</span></span>
<span id="cb12-104"><a href="data-wrangling.html#cb12-104" aria-hidden="true" tabindex="-1"></a>        <span class="fu">seq</span>(</span>
<span id="cb12-105"><a href="data-wrangling.html#cb12-105" aria-hidden="true" tabindex="-1"></a>          <span class="at">from =</span> <span class="dv">0</span>, <span class="at">by =</span> <span class="fl">0.001</span>,</span>
<span id="cb12-106"><a href="data-wrangling.html#cb12-106" aria-hidden="true" tabindex="-1"></a>          <span class="at">length.out =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">length</span>(<span class="fu">t</span>(mat_import<span class="sc">$</span>spikes))</span>
<span id="cb12-107"><a href="data-wrangling.html#cb12-107" aria-hidden="true" tabindex="-1"></a>        ), <span class="co">#t(mat_import$tt),</span></span>
<span id="cb12-108"><a href="data-wrangling.html#cb12-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">Spikes =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">t</span>(mat_import<span class="sc">$</span>spikes)),</span>
<span id="cb12-109"><a href="data-wrangling.html#cb12-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">Photod =</span> <span class="fu">c</span>(<span class="dv">0</span>, mat_import<span class="sc">$</span>photodiode)</span>
<span id="cb12-110"><a href="data-wrangling.html#cb12-110" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb12-111"><a href="data-wrangling.html#cb12-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-112"><a href="data-wrangling.html#cb12-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time_char =</span> <span class="fu">as.character</span>(Time)) <span class="sc">%&gt;%</span></span>
<span id="cb12-113"><a href="data-wrangling.html#cb12-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Time <span class="sc">&lt;=</span> final_time)</span>
<span id="cb12-114"><a href="data-wrangling.html#cb12-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-115"><a href="data-wrangling.html#cb12-115" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Merge the matlab data with the metadata</span></span>
<span id="cb12-116"><a href="data-wrangling.html#cb12-116" aria-hidden="true" tabindex="-1"></a>  joined_one_full <span class="ot">&lt;-</span></span>
<span id="cb12-117"><a href="data-wrangling.html#cb12-117" aria-hidden="true" tabindex="-1"></a>    mat_data_sets[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb12-118"><a href="data-wrangling.html#cb12-118" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Join by the character version of time NOT the numerical!!</span></span>
<span id="cb12-119"><a href="data-wrangling.html#cb12-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(first_csv, <span class="at">by =</span> <span class="st">&quot;Time_char&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-120"><a href="data-wrangling.html#cb12-120" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Rename columns for clarity of reference</span></span>
<span id="cb12-121"><a href="data-wrangling.html#cb12-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Time_mat =</span> Time.x,</span>
<span id="cb12-122"><a href="data-wrangling.html#cb12-122" aria-hidden="true" tabindex="-1"></a>           <span class="at">Time_csv =</span> Time.y) <span class="sc">%&gt;%</span></span>
<span id="cb12-123"><a href="data-wrangling.html#cb12-123" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Convert character time to numeric time</span></span>
<span id="cb12-124"><a href="data-wrangling.html#cb12-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.numeric</span>(Time_char)) <span class="sc">%&gt;%</span></span>
<span id="cb12-125"><a href="data-wrangling.html#cb12-125" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Carry metadata forward</span></span>
<span id="cb12-126"><a href="data-wrangling.html#cb12-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-127"><a href="data-wrangling.html#cb12-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">Trial =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(Trial, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>),</span>
<span id="cb12-128"><a href="data-wrangling.html#cb12-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">Spatial_Frequency =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(Spatial_Frequency, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>),</span>
<span id="cb12-129"><a href="data-wrangling.html#cb12-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">SF_cpd =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(SF_cpd, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>),</span>
<span id="cb12-130"><a href="data-wrangling.html#cb12-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">Temporal_Frequency =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(Temporal_Frequency, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>),</span>
<span id="cb12-131"><a href="data-wrangling.html#cb12-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">Direction =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(Direction, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>),</span>
<span id="cb12-132"><a href="data-wrangling.html#cb12-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time_csv =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(Time_csv, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>),</span>
<span id="cb12-133"><a href="data-wrangling.html#cb12-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">Stim_end =</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(Stim_end, <span class="at">type =</span> <span class="st">&quot;locf&quot;</span>)</span>
<span id="cb12-134"><a href="data-wrangling.html#cb12-134" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb12-135"><a href="data-wrangling.html#cb12-135" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Calculate velocity</span></span>
<span id="cb12-136"><a href="data-wrangling.html#cb12-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-137"><a href="data-wrangling.html#cb12-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">Speed =</span> Temporal_Frequency<span class="sc">/</span>SF_cpd,</span>
<span id="cb12-138"><a href="data-wrangling.html#cb12-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">Log2_Speed =</span> <span class="fu">log2</span>(Speed)</span>
<span id="cb12-139"><a href="data-wrangling.html#cb12-139" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb12-140"><a href="data-wrangling.html#cb12-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-141"><a href="data-wrangling.html#cb12-141" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Add info to metadata</span></span>
<span id="cb12-142"><a href="data-wrangling.html#cb12-142" aria-hidden="true" tabindex="-1"></a>  metadata_one_full <span class="ot">&lt;-</span></span>
<span id="cb12-143"><a href="data-wrangling.html#cb12-143" aria-hidden="true" tabindex="-1"></a>    first_csv <span class="sc">%&gt;%</span></span>
<span id="cb12-144"><a href="data-wrangling.html#cb12-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-145"><a href="data-wrangling.html#cb12-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">Speed =</span> Temporal_Frequency<span class="sc">/</span>SF_cpd,</span>
<span id="cb12-146"><a href="data-wrangling.html#cb12-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">Log2_Speed =</span> <span class="fu">log2</span>(Speed),</span>
<span id="cb12-147"><a href="data-wrangling.html#cb12-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">Stim_end_diff =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(Stim_end))</span>
<span id="cb12-148"><a href="data-wrangling.html#cb12-148" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb12-149"><a href="data-wrangling.html#cb12-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-150"><a href="data-wrangling.html#cb12-150" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Some quality control checks</span></span>
<span id="cb12-151"><a href="data-wrangling.html#cb12-151" aria-hidden="true" tabindex="-1"></a>  <span class="do">## What are the stim time differences?</span></span>
<span id="cb12-152"><a href="data-wrangling.html#cb12-152" aria-hidden="true" tabindex="-1"></a>  stimtime_diffs <span class="ot">&lt;-</span> <span class="fu">round</span>(metadata_one_full<span class="sc">$</span>Stim_end_diff)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span>
<span id="cb12-153"><a href="data-wrangling.html#cb12-153" aria-hidden="true" tabindex="-1"></a>  <span class="do">## How many total reps were recorded?</span></span>
<span id="cb12-154"><a href="data-wrangling.html#cb12-154" aria-hidden="true" tabindex="-1"></a>  stimtime_reps <span class="ot">&lt;-</span> <span class="fu">length</span>(stimtime_diffs)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb12-155"><a href="data-wrangling.html#cb12-155" aria-hidden="true" tabindex="-1"></a>  <span class="do">## What do we expect the overall structure to look like?</span></span>
<span id="cb12-156"><a href="data-wrangling.html#cb12-156" aria-hidden="true" tabindex="-1"></a>  stimtime_expectation <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>), stimtime_reps)</span>
<span id="cb12-157"><a href="data-wrangling.html#cb12-157" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Does reality match our expectations?</span></span>
<span id="cb12-158"><a href="data-wrangling.html#cb12-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(stimtime_diffs <span class="sc">==</span> stimtime_expectation)) {</span>
<span id="cb12-159"><a href="data-wrangling.html#cb12-159" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If you get this, investigate the file further and determine what went</span></span>
<span id="cb12-160"><a href="data-wrangling.html#cb12-160" aria-hidden="true" tabindex="-1"></a>    <span class="do">## wrong</span></span>
<span id="cb12-161"><a href="data-wrangling.html#cb12-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;stimtime issue; investigate&quot;</span>) </span>
<span id="cb12-162"><a href="data-wrangling.html#cb12-162" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-163"><a href="data-wrangling.html#cb12-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-164"><a href="data-wrangling.html#cb12-164" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Sometimes the final sweep gets carried for an indefinite amount of time</span></span>
<span id="cb12-165"><a href="data-wrangling.html#cb12-165" aria-hidden="true" tabindex="-1"></a>  <span class="do">## before the investigator manually shuts things off. The following block</span></span>
<span id="cb12-166"><a href="data-wrangling.html#cb12-166" aria-hidden="true" tabindex="-1"></a>  <span class="do">## truncates accordingly</span></span>
<span id="cb12-167"><a href="data-wrangling.html#cb12-167" aria-hidden="true" tabindex="-1"></a>  mark_for_removal <span class="ot">&lt;-</span></span>
<span id="cb12-168"><a href="data-wrangling.html#cb12-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">which</span>(<span class="fu">round</span>(metadata_one_full<span class="sc">$</span>Stim_end_diff) <span class="sc">%not_in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb12-169"><a href="data-wrangling.html#cb12-169" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(mark_for_removal <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> mark_for_removal <span class="sc">==</span> <span class="dv">2</span>)) {</span>
<span id="cb12-170"><a href="data-wrangling.html#cb12-170" aria-hidden="true" tabindex="-1"></a>    mark_for_removal <span class="ot">&lt;-</span> mark_for_removal[mark_for_removal <span class="sc">&gt;</span> <span class="dv">2</span>]</span>
<span id="cb12-171"><a href="data-wrangling.html#cb12-171" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-172"><a href="data-wrangling.html#cb12-172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(mark_for_removal) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-173"><a href="data-wrangling.html#cb12-173" aria-hidden="true" tabindex="-1"></a>    metadata_sets[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-174"><a href="data-wrangling.html#cb12-174" aria-hidden="true" tabindex="-1"></a>      metadata_one_full <span class="sc">%&gt;%</span></span>
<span id="cb12-175"><a href="data-wrangling.html#cb12-175" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Time <span class="sc">&lt;</span> metadata_one_full[mark_for_removal[<span class="dv">1</span>],]<span class="sc">$</span>Time)</span>
<span id="cb12-176"><a href="data-wrangling.html#cb12-176" aria-hidden="true" tabindex="-1"></a>    joined_data_sets[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-177"><a href="data-wrangling.html#cb12-177" aria-hidden="true" tabindex="-1"></a>      joined_one_full <span class="sc">%&gt;%</span></span>
<span id="cb12-178"><a href="data-wrangling.html#cb12-178" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Time_mat <span class="sc">&lt;</span> metadata_one_full[mark_for_removal[<span class="dv">1</span>],]<span class="sc">$</span>Time)</span>
<span id="cb12-179"><a href="data-wrangling.html#cb12-179" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-180"><a href="data-wrangling.html#cb12-180" aria-hidden="true" tabindex="-1"></a>    metadata_sets[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-181"><a href="data-wrangling.html#cb12-181" aria-hidden="true" tabindex="-1"></a>      metadata_one_full</span>
<span id="cb12-182"><a href="data-wrangling.html#cb12-182" aria-hidden="true" tabindex="-1"></a>    joined_data_sets[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-183"><a href="data-wrangling.html#cb12-183" aria-hidden="true" tabindex="-1"></a>      joined_one_full</span>
<span id="cb12-184"><a href="data-wrangling.html#cb12-184" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-185"><a href="data-wrangling.html#cb12-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-186"><a href="data-wrangling.html#cb12-186" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Organize the metadata for export in the R environment</span></span>
<span id="cb12-187"><a href="data-wrangling.html#cb12-187" aria-hidden="true" tabindex="-1"></a>  meta_splits[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-188"><a href="data-wrangling.html#cb12-188" aria-hidden="true" tabindex="-1"></a>    metadata_sets[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb12-189"><a href="data-wrangling.html#cb12-189" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Get rid of the non-sweep info</span></span>
<span id="cb12-190"><a href="data-wrangling.html#cb12-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Trial <span class="sc">==</span> <span class="st">&quot;inception&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-191"><a href="data-wrangling.html#cb12-191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Trial <span class="sc">==</span> <span class="st">&quot;initialization&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-192"><a href="data-wrangling.html#cb12-192" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Group by trial</span></span>
<span id="cb12-193"><a href="data-wrangling.html#cb12-193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Spatial_Frequency, Temporal_Frequency, Direction) <span class="sc">%&gt;%</span></span>
<span id="cb12-194"><a href="data-wrangling.html#cb12-194" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Split by trial group</span></span>
<span id="cb12-195"><a href="data-wrangling.html#cb12-195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_split</span>()</span>
<span id="cb12-196"><a href="data-wrangling.html#cb12-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-197"><a href="data-wrangling.html#cb12-197" aria-hidden="true" tabindex="-1"></a>  data_splits[[i]] <span class="ot">&lt;-</span></span>
<span id="cb12-198"><a href="data-wrangling.html#cb12-198" aria-hidden="true" tabindex="-1"></a>    joined_data_sets[[i]] <span class="sc">%&gt;%</span></span>
<span id="cb12-199"><a href="data-wrangling.html#cb12-199" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Get rid of the non-sweep info</span></span>
<span id="cb12-200"><a href="data-wrangling.html#cb12-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Trial <span class="sc">==</span> <span class="st">&quot;inception&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-201"><a href="data-wrangling.html#cb12-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Trial <span class="sc">==</span> <span class="st">&quot;initialization&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-202"><a href="data-wrangling.html#cb12-202" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Group by trial</span></span>
<span id="cb12-203"><a href="data-wrangling.html#cb12-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Spatial_Frequency, Temporal_Frequency, Direction) <span class="sc">%&gt;%</span></span>
<span id="cb12-204"><a href="data-wrangling.html#cb12-204" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Split by trial group</span></span>
<span id="cb12-205"><a href="data-wrangling.html#cb12-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_split</span>()</span>
<span id="cb12-206"><a href="data-wrangling.html#cb12-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-207"><a href="data-wrangling.html#cb12-207" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Do some cleanup so large objects don&#39;t linger in memor</span></span>
<span id="cb12-208"><a href="data-wrangling.html#cb12-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(</span>
<span id="cb12-209"><a href="data-wrangling.html#cb12-209" aria-hidden="true" tabindex="-1"></a>    first_csv, inception, initial, mat_import, first_csv_tmp, metadata_one_full,</span>
<span id="cb12-210"><a href="data-wrangling.html#cb12-210" aria-hidden="true" tabindex="-1"></a>    joined_one_full, joined_data_sets, csv_data_sets, mat_data_sets</span>
<span id="cb12-211"><a href="data-wrangling.html#cb12-211" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-212"><a href="data-wrangling.html#cb12-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;File &quot;</span>, i, <span class="st">&quot;: &quot;</span>, csv_mat_filejoin[i,<span class="st">&quot;basename&quot;</span>], <span class="st">&quot; imported&quot;</span>)</span>
<span id="cb12-213"><a href="data-wrangling.html#cb12-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb12-214"><a href="data-wrangling.html#cb12-214" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] &quot;stimtime issue; investigate&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-wrangling.html#cb14-1" aria-hidden="true" tabindex="-1"></a>endtime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>() </span>
<span id="cb14-2"><a href="data-wrangling.html#cb14-2" aria-hidden="true" tabindex="-1"></a>endtime <span class="sc">-</span> starttime <span class="do">## Total elapsed time</span></span></code></pre></div>
<pre><code>## Time difference of 53.68572 secs</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-wrangling.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tidy up</span></span>
<span id="cb16-2"><a href="data-wrangling.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##            used  (Mb) gc trigger   (Mb)  max used   (Mb)
## Ncells  4156763 222.0    9140687  488.2   5144973  274.8
## Vcells 28549668 217.9  368324061 2810.1 711820837 5430.8</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-wrangling.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Name each data set according to the basename of the file</span></span>
<span id="cb18-2"><a href="data-wrangling.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(metadata_sets) <span class="ot">&lt;-</span> csv_mat_filejoin<span class="sc">$</span>basename <span class="co">#base_names</span></span>
<span id="cb18-3"><a href="data-wrangling.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(meta_splits)   <span class="ot">&lt;-</span> csv_mat_filejoin<span class="sc">$</span>basename <span class="co">#base_names</span></span>
<span id="cb18-4"><a href="data-wrangling.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data_splits)   <span class="ot">&lt;-</span> csv_mat_filejoin<span class="sc">$</span>basename <span class="co">#base_names</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="raw-data-and-spike-sorted-traces.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="raster-and-mean-spike-rate-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-data_wrangling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
