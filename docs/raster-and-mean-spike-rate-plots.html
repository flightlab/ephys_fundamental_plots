<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Raster and mean spike rate plots | Fundamental plots for electrophysiological data</title>
  <meta name="description" content="<p>A walkthrough on how to produce fundamental plots from electrophysiological
data. Developed by the Alshuler Lab at the University of British Columbia.</p>" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Raster and mean spike rate plots | Fundamental plots for electrophysiological data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>A walkthrough on how to produce fundamental plots from electrophysiological
data. Developed by the Alshuler Lab at the University of British Columbia.</p>" />
  <meta name="github-repo" content="flightlab/ephys_fundamental_plots" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Raster and mean spike rate plots | Fundamental plots for electrophysiological data" />
  
  <meta name="twitter:description" content="<p>A walkthrough on how to produce fundamental plots from electrophysiological
data. Developed by the Alshuler Lab at the University of British Columbia.</p>" />
  

<meta name="author" content="Vikram B. Baliga" />


<meta name="date" content="2023-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="direction-tuning.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamental plots for electrophysiological data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>2</b> Preface</a>
<ul>
<li class="chapter" data-level="2.1" data-path="preface.html"><a href="preface.html#r-packages-versioning"><i class="fa fa-check"></i><b>2.1</b> R packages &amp; versioning</a></li>
<li class="chapter" data-level="2.2" data-path="preface.html"><a href="preface.html#not_in"><i class="fa fa-check"></i><b>2.2</b> <code>%not_in%</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spike-sorting.html"><a href="spike-sorting.html"><i class="fa fa-check"></i><b>3</b> Spike sorting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spike-sorting.html"><a href="spike-sorting.html#spike2"><i class="fa fa-check"></i><b>3.1</b> Spike2</a></li>
<li class="chapter" data-level="3.2" data-path="spike-sorting.html"><a href="spike-sorting.html#neuralynx"><i class="fa fa-check"></i><b>3.2</b> Neuralynx</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raw-data-and-spike-sorted-traces.html"><a href="raw-data-and-spike-sorted-traces.html"><i class="fa fa-check"></i><b>4</b> Raw data and spike sorted traces</a>
<ul>
<li class="chapter" data-level="4.1" data-path="raw-data-and-spike-sorted-traces.html"><a href="raw-data-and-spike-sorted-traces.html#including-plots"><i class="fa fa-check"></i><b>4.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#import-example-file-and-metadata"><i class="fa fa-check"></i><b>5.1</b> Import example file and metadata</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#identify-files-to-import"><i class="fa fa-check"></i><b>5.1.1</b> Identify files to import</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-import-and-preliminary-labeling"><i class="fa fa-check"></i><b>5.1.2</b> Data import and preliminary labeling</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#organizing-replicates-required-and-binning-optional"><i class="fa fa-check"></i><b>5.2</b> Organizing replicates (required) and binning (optional)</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#data-export"><i class="fa fa-check"></i><b>5.3</b> Data export</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html"><i class="fa fa-check"></i><b>6</b> Raster and mean spike rate plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html#data-sets"><i class="fa fa-check"></i><b>6.1</b> Data sets</a></li>
<li class="chapter" data-level="6.2" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html#raster-plot"><i class="fa fa-check"></i><b>6.2</b> Raster plot</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html#export-to-pdf"><i class="fa fa-check"></i><b>6.2.1</b> Export to PDF</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="raster-and-mean-spike-rate-plots.html"><a href="raster-and-mean-spike-rate-plots.html#mean-spike-rate-plots"><i class="fa fa-check"></i><b>6.3</b> Mean spike rate plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="direction-tuning.html"><a href="direction-tuning.html"><i class="fa fa-check"></i><b>7</b> Direction tuning</a>
<ul>
<li class="chapter" data-level="7.1" data-path="direction-tuning.html"><a href="direction-tuning.html#including-plots-1"><i class="fa fa-check"></i><b>7.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatiotemporal-tuning.html"><a href="spatiotemporal-tuning.html"><i class="fa fa-check"></i><b>8</b> Spatiotemporal tuning</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatiotemporal-tuning.html"><a href="spatiotemporal-tuning.html#including-plots-2"><i class="fa fa-check"></i><b>8.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="histological-verification.html"><a href="histological-verification.html"><i class="fa fa-check"></i><b>9</b> Histological verification</a>
<ul>
<li class="chapter" data-level="9.1" data-path="histological-verification.html"><a href="histological-verification.html#including-plots-3"><i class="fa fa-check"></i><b>9.1</b> Including Plots</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamental plots for electrophysiological data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="raster-and-mean-spike-rate-plots" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Raster and mean spike rate plots<a href="raster-and-mean-spike-rate-plots.html#raster-and-mean-spike-rate-plots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="data-sets" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Data sets<a href="raster-and-mean-spike-rate-plots.html#data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section will rely on some of the unbinned and binned data we exported in
final steps of the previous section. We’ll start by loading in information</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="raster-and-mean-spike-rate-plots.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## File paths and basenames of _unbinned.csv files</span></span>
<span id="cb33-2"><a href="raster-and-mean-spike-rate-plots.html#cb33-2" aria-hidden="true" tabindex="-1"></a>unbinned_filelist <span class="ot">&lt;-</span></span>
<span id="cb33-3"><a href="raster-and-mean-spike-rate-plots.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">&quot;./data/&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;_unbinned.csv&quot;</span>,</span>
<span id="cb33-4"><a href="raster-and-mean-spike-rate-plots.html#cb33-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-5"><a href="raster-and-mean-spike-rate-plots.html#cb33-5" aria-hidden="true" tabindex="-1"></a>unbinned_basenames <span class="ot">&lt;-</span></span>
<span id="cb33-6"><a href="raster-and-mean-spike-rate-plots.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  unbinned_filelist <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="raster-and-mean-spike-rate-plots.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="st">&quot;./data/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="raster-and-mean-spike-rate-plots.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="st">&quot;_unbinned.csv&quot;</span>)</span>
<span id="cb33-9"><a href="raster-and-mean-spike-rate-plots.html#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="raster-and-mean-spike-rate-plots.html#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="do">## File paths and basenames of _binsize10.csv files</span></span>
<span id="cb33-11"><a href="raster-and-mean-spike-rate-plots.html#cb33-11" aria-hidden="true" tabindex="-1"></a>bin10_filelist <span class="ot">&lt;-</span></span>
<span id="cb33-12"><a href="raster-and-mean-spike-rate-plots.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">&quot;./data/&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;_binsize10.csv&quot;</span>,</span>
<span id="cb33-13"><a href="raster-and-mean-spike-rate-plots.html#cb33-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-14"><a href="raster-and-mean-spike-rate-plots.html#cb33-14" aria-hidden="true" tabindex="-1"></a>bin10_basenames <span class="ot">&lt;-</span></span>
<span id="cb33-15"><a href="raster-and-mean-spike-rate-plots.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  bin10_filelist <span class="sc">%&gt;%</span></span>
<span id="cb33-16"><a href="raster-and-mean-spike-rate-plots.html#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="st">&quot;./data/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-17"><a href="raster-and-mean-spike-rate-plots.html#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="st">&quot;_binsize10.csv&quot;</span>)</span>
<span id="cb33-18"><a href="raster-and-mean-spike-rate-plots.html#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="raster-and-mean-spike-rate-plots.html#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="do">## File paths and basenames of _binsize100.csv files</span></span>
<span id="cb33-20"><a href="raster-and-mean-spike-rate-plots.html#cb33-20" aria-hidden="true" tabindex="-1"></a>bin100_filelist <span class="ot">&lt;-</span></span>
<span id="cb33-21"><a href="raster-and-mean-spike-rate-plots.html#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">&quot;./data/&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;_binsize100.csv&quot;</span>,</span>
<span id="cb33-22"><a href="raster-and-mean-spike-rate-plots.html#cb33-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-23"><a href="raster-and-mean-spike-rate-plots.html#cb33-23" aria-hidden="true" tabindex="-1"></a>bin100_basenames <span class="ot">&lt;-</span></span>
<span id="cb33-24"><a href="raster-and-mean-spike-rate-plots.html#cb33-24" aria-hidden="true" tabindex="-1"></a>  bin100_filelist <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="raster-and-mean-spike-rate-plots.html#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="st">&quot;./data/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-26"><a href="raster-and-mean-spike-rate-plots.html#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove</span>(<span class="st">&quot;_binsize100.csv&quot;</span>)</span></code></pre></div>
<p>You should have something similar to the following:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="raster-and-mean-spike-rate-plots.html#cb34-1" aria-hidden="true" tabindex="-1"></a>unbinned_filelist; unbinned_basenames; bin10_filelist; bin10_basenames; bin100_filelist; bin100_basenames</span></code></pre></div>
<pre><code>## [1] &quot;./data/04132022_009m_unbinned.csv&quot;</code></pre>
<pre><code>## [1] &quot;04132022_009m&quot;</code></pre>
<pre><code>## [1] &quot;./data/04132022_009m_binsize10.csv&quot;</code></pre>
<pre><code>## [1] &quot;04132022_009m&quot;</code></pre>
<pre><code>## [1] &quot;./data/04132022_009m_binsize100.csv&quot;</code></pre>
<pre><code>## [1] &quot;04132022_009m&quot;</code></pre>
</div>
<div id="raster-plot" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Raster plot<a href="raster-and-mean-spike-rate-plots.html#raster-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is an example of a raster plot, using the wrangled data generated in the
previous section. This type of plot shows the timing of spike events within
each replicate sweep, and for our purposes, we’ll produce a view of this for
each of the various stimulus conditions</p>
<p>It is important to note that we will need unbinned data for this. This is
because a raster plot shows discrete spiking events through the course of a time
sweep.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="raster-and-mean-spike-rate-plots.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in unbinned data</span></span>
<span id="cb41-2"><a href="raster-and-mean-spike-rate-plots.html#cb41-2" aria-hidden="true" tabindex="-1"></a>unbinned_data <span class="ot">&lt;-</span></span>
<span id="cb41-3"><a href="raster-and-mean-spike-rate-plots.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">&quot;./data/04132022_009m_unbinned.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="raster-and-mean-spike-rate-plots.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb41-5"><a href="raster-and-mean-spike-rate-plots.html#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="raster-and-mean-spike-rate-plots.html#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate the code for the ggplot and save it as &quot;plot&quot;</span></span>
<span id="cb41-7"><a href="raster-and-mean-spike-rate-plots.html#cb41-7" aria-hidden="true" tabindex="-1"></a>rasterplot <span class="ot">&lt;-</span></span>
<span id="cb41-8"><a href="raster-and-mean-spike-rate-plots.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  unbinned_data <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="raster-and-mean-spike-rate-plots.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Remove any rows where spiking does not occur in the Spikes column</span></span>
<span id="cb41-10"><a href="raster-and-mean-spike-rate-plots.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Spikes <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="raster-and-mean-spike-rate-plots.html#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Convert Trial and Speed into factors and specify their level ordering</span></span>
<span id="cb41-12"><a href="raster-and-mean-spike-rate-plots.html#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## This will make it easier to get the subplots in the order we want them</span></span>
<span id="cb41-13"><a href="raster-and-mean-spike-rate-plots.html#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trial =</span> <span class="fu">factor</span>(Trial, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;blank&quot;</span>, <span class="st">&quot;stationary&quot;</span>, <span class="st">&quot;moving&quot;</span>)),</span>
<span id="cb41-14"><a href="raster-and-mean-spike-rate-plots.html#cb41-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Speed =</span> <span class="fu">factor</span>(Speed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1024</span>, <span class="dv">256</span>, <span class="dv">32</span>, <span class="dv">4</span>, <span class="fl">0.5</span>, <span class="fl">0.062</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="raster-and-mean-spike-rate-plots.html#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Time_stand, <span class="at">y =</span> Replicate)) <span class="sc">+</span></span>
<span id="cb41-16"><a href="raster-and-mean-spike-rate-plots.html#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## The next three blocks will undershade each subplot according to stimulus</span></span>
<span id="cb41-17"><a href="raster-and-mean-spike-rate-plots.html#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## phase (i.e., blank, stationary, moving)</span></span>
<span id="cb41-18"><a href="raster-and-mean-spike-rate-plots.html#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb41-19"><a href="raster-and-mean-spike-rate-plots.html#cb41-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="fu">first</span>(unbinned_data<span class="sc">$</span>Blank_end),</span>
<span id="cb41-20"><a href="raster-and-mean-spike-rate-plots.html#cb41-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="fl">0.5</span>, <span class="at">ymax =</span> <span class="fl">10.5</span>,</span>
<span id="cb41-21"><a href="raster-and-mean-spike-rate-plots.html#cb41-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-22"><a href="raster-and-mean-spike-rate-plots.html#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb41-23"><a href="raster-and-mean-spike-rate-plots.html#cb41-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">first</span>(unbinned_data<span class="sc">$</span>Blank_end),</span>
<span id="cb41-24"><a href="raster-and-mean-spike-rate-plots.html#cb41-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmax =</span> <span class="fu">first</span>(unbinned_data<span class="sc">$</span>Static_end),</span>
<span id="cb41-25"><a href="raster-and-mean-spike-rate-plots.html#cb41-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="fl">0.5</span>, <span class="at">ymax =</span> <span class="fl">10.5</span>,</span>
<span id="cb41-26"><a href="raster-and-mean-spike-rate-plots.html#cb41-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-27"><a href="raster-and-mean-spike-rate-plots.html#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb41-28"><a href="raster-and-mean-spike-rate-plots.html#cb41-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fu">first</span>(unbinned_data<span class="sc">$</span>Static_end), <span class="at">xmax =</span> <span class="dv">5</span>,</span>
<span id="cb41-29"><a href="raster-and-mean-spike-rate-plots.html#cb41-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="fl">0.5</span>, <span class="at">ymax =</span> <span class="fl">10.5</span>,</span>
<span id="cb41-30"><a href="raster-and-mean-spike-rate-plots.html#cb41-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;forestgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-31"><a href="raster-and-mean-spike-rate-plots.html#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Up to 10 replicates were used, so we will force the y-axis to go to 10</span></span>
<span id="cb41-32"><a href="raster-and-mean-spike-rate-plots.html#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb41-33"><a href="raster-and-mean-spike-rate-plots.html#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">10.5</span>),</span>
<span id="cb41-34"><a href="raster-and-mean-spike-rate-plots.html#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb41-35"><a href="raster-and-mean-spike-rate-plots.html#cb41-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb41-36"><a href="raster-and-mean-spike-rate-plots.html#cb41-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-37"><a href="raster-and-mean-spike-rate-plots.html#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">## There are multiple ways to plot a spike event. Since 100% of the rows in</span></span>
<span id="cb41-38"><a href="raster-and-mean-spike-rate-plots.html#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">## this filtered data set are spike events, we can simply plot a symbol at</span></span>
<span id="cb41-39"><a href="raster-and-mean-spike-rate-plots.html#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="do">## each time (Time_stand) that appears in the data. The `|` symbol is a good</span></span>
<span id="cb41-40"><a href="raster-and-mean-spike-rate-plots.html#cb41-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## choice.</span></span>
<span id="cb41-41"><a href="raster-and-mean-spike-rate-plots.html#cb41-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">pch =</span> <span class="st">&#39;|&#39;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb41-42"><a href="raster-and-mean-spike-rate-plots.html#cb41-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Time (sec)&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-43"><a href="raster-and-mean-spike-rate-plots.html#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;04132022_009m raster&quot;</span>)) <span class="sc">+</span></span>
<span id="cb41-44"><a href="raster-and-mean-spike-rate-plots.html#cb41-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Use facet_grid() to create a grid of subplots. Rows will correspond to </span></span>
<span id="cb41-45"><a href="raster-and-mean-spike-rate-plots.html#cb41-45" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Speeds, and columns correspond to Directions</span></span>
<span id="cb41-46"><a href="raster-and-mean-spike-rate-plots.html#cb41-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(Speed), <span class="at">cols =</span> <span class="fu">vars</span>(Direction)) <span class="sc">+</span></span>
<span id="cb41-47"><a href="raster-and-mean-spike-rate-plots.html#cb41-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb41-48"><a href="raster-and-mean-spike-rate-plots.html#cb41-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb41-49"><a href="raster-and-mean-spike-rate-plots.html#cb41-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>))</span>
<span id="cb41-50"><a href="raster-and-mean-spike-rate-plots.html#cb41-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-51"><a href="raster-and-mean-spike-rate-plots.html#cb41-51" aria-hidden="true" tabindex="-1"></a>rasterplot</span></code></pre></div>
<p><img src="_main_files/figure-html/raster_plot-1.png" width="672" /></p>
<div id="export-to-pdf" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Export to PDF<a href="raster-and-mean-spike-rate-plots.html#export-to-pdf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Should you elect to export this plot by itself to a <code>PDF</code>, you can do the
following:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="raster-and-mean-spike-rate-plots.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Should you elect to export this as a PDF</span></span>
<span id="cb42-2"><a href="raster-and-mean-spike-rate-plots.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(</span>
<span id="cb42-3"><a href="raster-and-mean-spike-rate-plots.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./path/to/directory/filename.pdf&quot;</span>,</span>
<span id="cb42-4"><a href="raster-and-mean-spike-rate-plots.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="fl">10.5</span>,</span>
<span id="cb42-5"><a href="raster-and-mean-spike-rate-plots.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb42-6"><a href="raster-and-mean-spike-rate-plots.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;04132022_009m raster&quot;</span>,</span>
<span id="cb42-7"><a href="raster-and-mean-spike-rate-plots.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">paper =</span> <span class="st">&quot;USr&quot;</span>,</span>
<span id="cb42-8"><a href="raster-and-mean-spike-rate-plots.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb42-9"><a href="raster-and-mean-spike-rate-plots.html#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pagecentre =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-10"><a href="raster-and-mean-spike-rate-plots.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">colormodel =</span> <span class="st">&quot;srgb&quot;</span></span>
<span id="cb42-11"><a href="raster-and-mean-spike-rate-plots.html#cb42-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-12"><a href="raster-and-mean-spike-rate-plots.html#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rasterplot)</span>
<span id="cb42-13"><a href="raster-and-mean-spike-rate-plots.html#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="mean-spike-rate-plots" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Mean spike rate plots<a href="raster-and-mean-spike-rate-plots.html#mean-spike-rate-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="direction-tuning.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "tango",
"info": true
});
});
</script>

</body>

</html>
